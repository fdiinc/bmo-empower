<?xml version="1.0"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:output method="text" indent="yes" encoding="utf-8" standalone="yes"/><xsl:strip-space elements="*"/><xsl:template match="/*"><!-- For each lineitem of result --><xsl:for-each select="*"><!-- Insert additional row for header --><xsl:if test="position() = 1"><xsl:for-each select="attribute::*"><xsl:if test="name() != 'type' and name() != 'uri' and name()!='title'">"<xsl:value-of select="name()"/>"<xsl:if test="position() != last()"><xsl:text>,</xsl:text></xsl:if></xsl:if></xsl:for-each><xsl:value-of select="&quot;&#xA;&quot;" disable-output-escaping="yes"/></xsl:if><xsl:for-each select="attribute::*"><xsl:if test="name() != 'type' and name() != 'uri' and name()!='title'">"<xsl:value-of select="."/>"<xsl:if test="position() != last()"><xsl:text>,</xsl:text></xsl:if></xsl:if></xsl:for-each><!-- This is an odd syntax for forcing the CRLF out - otherwise entity substitution happens early
                            	We had better luck doing this in an attribute rather than a text node. Default xdb and dds import does
                            	not allow whitespace in elements. --><xsl:value-of select="&quot;&#xA;&quot;" disable-output-escaping="yes"/></xsl:for-each></xsl:template></xsl:stylesheet>